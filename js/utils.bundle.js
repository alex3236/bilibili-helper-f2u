"use strict";(self["webpackChunkbilibilihelper2"]=self["webpackChunkbilibilihelper2"]||[]).push([[133],{25498:(e,t,n)=>{n.r(t),n.d(t,{checkLivePlayerInitialized:()=>o.Q,setLivePlayerControllerVisible:()=>o.i});var i=n(90137),r={};for(const a in i)"default"!==a&&(r[a]=()=>i[a]);n.d(t,r);var o=n(26702)},26702:(e,t,n)=>{n.d(t,{Q:()=>o,i:()=>a});var i=n(73473),r=n.n(i);const o=()=>new(r())(e=>{const t="\n            (function() {\n                const t = setInterval(() => {\n                    let player = window.livePlayer || (window.EmbedPlayer && window.EmbedPlayer.instance);\n                    if (player) {\n                        window.postMessage({command: 'sendLivePlayerInitialized', data: !!player}, '*');\n                        clearInterval(t);\n                    }\n                }, 1000);\n            })();\n        ",n=document.createElement("script");n.innerHTML=t,document.body.appendChild(n);const i=t=>{const{data:r}=t;"sendLivePlayerInitialized"===r.command&&(e(r.data),n.remove(),window.removeEventListener("message",i))};window.addEventListener("message",i)}),a=e=>new(r())(t=>{if(void 0===e)return t(!1);const n=`\n            (function() {\n                let player = window.livePlayer || (window.EmbedPlayer && window.EmbedPlayer.instance);\n                if (player) {\n                    player.changeCtrlVisible(${e});\n                    window.postMessage({command: 'sendHasSetLivePlayerVisible', done: true}, '*');\n                } else {\n                    window.postMessage({command: 'sendHasSetLivePlayerVisible', done: false}, '*');\n                }\n            })()\n        `,i=document.createElement("script");i.innerHTML=n,document.body.appendChild(i);const r=e=>{const{data:n}=e;"sendHasSetLivePlayerVisible"===n.command&&(window.removeEventListener("message",r),i.remove(),t(n.done))};window.addEventListener("message",r)})},49675:(e,t,n)=>{n.r(t),n.d(t,{hasExpired:()=>u,isPublishBeta:()=>c,isSuperVIP:()=>d,isVIP:()=>s});var i=n(66130),r=n.n(i),o=n(15364),a=n(30381),l=n.n(a);const c=e=>"publicBeta"===e,s=(e,t=o.VIP_USER_IDENTITIES_KEY_LIST)=>{if(!e||!e.identities||0===e.identities.length)return!1;const n=r()();return e.identities.map(({name:e,to:i,hasDateTimeLimit:r})=>!(!t.includes(e)||!(i&&i>n)&&r)).filter(Boolean).length>0},d=e=>s(e,o.SUPER_VIP_USER_IDENTITIES_KEY_LIST),u=(e,t=30)=>{if(!e||!e.identities||0===e.identities.length)return!1;const n=r()(),i=o.VIP_USER_IDENTITIES_KEY_LIST,a=[],c=0===e.identities.map(e=>{const{name:r,to:o,hasDateTimeLimit:c}=e;if(i.includes(r)){if(o&&o>n||!c)return!1;if(o){const i=l().duration(n-o,"milliseconds").days();if(-1===t)return a.push(e),!0;if(i<=t)return a.push(e),!0}}return!1}).filter(Boolean).length;return!!(c&&a.length>0)}},47061:(e,t,n)=>{n.r(t),n.d(t,{getBrowserType:()=>c,getShellBrowserType:()=>l,is360Chrome:()=>i,is360Safe:()=>r,isEdge:()=>o,isFireFox:()=>a.t});const i=()=>!!(chrome&&chrome.webstorePrivate&&chrome.webstorePrivate.beginInstallWithManifest3)||!!~navigator.userAgent.toLowerCase().indexOf("360ee"),r=()=>{if(external&&external.GetRunPath&&external.GetSID){let e=external.GetRunPath(external.GetSID(window));return e=e.toLowerCase(),e.indexOf("360se.exe")>-1||e.indexOf("360ent")>-1}return!1},o=(e=navigator.userAgent.toLowerCase())=>!!e.match(/edg/g);var a=n(70799);const l=(e=navigator.userAgent.toLowerCase())=>e.indexOf("qqbrowser")>-1?"QQ\u6d4f\u89c8\u5668":e.indexOf("se")>-1?"\u641c\u72d7\u6d4f\u89c8\u5668":e.indexOf("2345Explorer")>-1?"2345\u6d4f\u89c8\u5668":e.indexOf("aoyou")>-1?"\u9068\u6e38\u6d4f\u89c8\u5668":e.indexOf("theworld")>-1?"\u4e16\u754c\u4e4b\u7a97\u6d4f\u89c8\u5668":e.indexOf("worldchrome")>-1?"\u4e16\u754c\u4e4b\u7a97\u6781\u901f\u6d4f\u89c8\u5668":e.indexOf("greenbrowser")>-1?"\u7eff\u8272\u6d4f\u89c8\u5668":e.indexOf("opera")>-1?"Opera":e.indexOf("taobrowser")>-1?"\u6dd8\u5b9d\u6d4f\u89c8\u5668":e.indexOf("baidu")>-1?"\u767e\u5ea6\u6d4f\u89c8\u5668":"\u672a\u77e5",c=()=>i()?"360Chrome":r()?"is360Safe":o()?"edge":(0,a.t)()?"firefox":l()},70799:(e,t,n)=>{n.d(t,{t:()=>i});const i=()=>{try{return"undefined"!==typeof InstallTrigger}catch(e){return!1}}},48950:(e,t,n)=>{n.d(t,{sc:()=>f,i$:()=>m,vu:()=>u,Ax:()=>v,eE:()=>b});n(73473);chrome.extension.getURL("html/config.html"),chrome.extension.getURL("html/popup.html");n(42151);if(869==n.j)var i=n(70799);const r="(\\*|http|https|file|ftp)",o="(\\*|(?:\\*\\.)?(?:[^/*]+))?",a="(.*)",l=new RegExp("^"+r+"://"+o+"/"+a+"$");function c(e){const t=l.exec(e);if(!t)return null;const n=t[1],i=t[2],r=t[3];return i||"file"===n?s(n,i,r):null}function s(e,t,n){let i="^";return i+="*"===e?"(http|https)":e,i+="://",t&&("*"===t?i+="([^/]+?)":(i+="(",t.match(/^\*\./)&&(i+="[^/]*?",t=t.substring(2)),i+=t.replace(/\./g,"\\.")+")")),n?"*"===n?i+="(/.*)?":(n=n.replace(/\?/g,"\\?"),"/"!==n[0]?(i+="(/",i+=n.replace(/\*/g,".*?"),i+=")"):i+=n.replace(/\*/g,".*?")):i+="\\/",i+="$",new RegExp(i)}let d;window.parse=c;const u=()=>{var e,t,n;if(d)return d;const i=null===(e=navigator)||void 0===e||null===(t=e.userAgentData)||void 0===t||null===(n=t.brands)||void 0===n?void 0:n.find(({brand:e})=>"Chromium"===e);if(i)return d=+i.version;{const e=navigator.userAgent.match(/Chrome\/(\d+)/);return d=!(!e||!e[1])&&+e[1]}},p=(e,t=(()=>{}))=>{chrome.tabs.create(e,t)},m=(e,t=(()=>{}))=>{p({url:e},t)},v=e=>chrome.extension.getURL(e),f=(e,t,n)=>((0,i.t)()&&delete t.buttons,chrome.notifications.create(e,t,n)),b=(()=>navigator.userAgentData?"macOS"===navigator.userAgentData.platform:/Mac OS/.test(navigator.userAgent))()},15558:(e,t,n)=>{n.d(t,{S1:()=>p,TD:()=>d,Zh:()=>u});var i=n(79529),r=n.n(i),o=n(66130),a=n.n(o),l=n(30381),c=n.n(l);const s=864e5,d=e=>{const t=r()(e/36e5,10),n=r()(e/6e4%60,10),i=r()(e/1e3%60,10),o=String(n).padStart(2,"0")+":"+String(i).padStart(2,"0");return t?String(t).padStart(2,"0")+":"+o:o},u=e=>(c().relativeTimeThreshold("h",24),c()(e).fromNow().replace("a few seconds ago","\u521a\u521a").replace(/(\d+) seconds ago/,"$1\u79d2\u524d").replace(/a minute ago/,"1\u5206\u949f\u524d").replace(/(\d+) minutes ago/,"$1\u5206\u949f\u524d").replace(/an hour ago/,"1\u5c0f\u65f6\u524d").replace(/(\d+) hours ago/,"$1\u5c0f\u65f6\u524d").replace(/a day ago/,"1\u5929\u524d").replace(/(\d+) days ago/,"$1\u5929\u524d").replace(/a month ago/,"1\u4e2a\u6708\u524d").replace(/(\d+) months ago/,"$1\u4e2a\u6708\u524d").replace(/a year ago/,"\u4e00\u5e74\u524d").replace(/(\d+) years ago/,"$1\u5e74\u524d")),p=e=>{const t=new Date(e),n=a()()-e;if(n>s){const e=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return[e,n].join("-")}return u(t)}},49355:(e,t,n)=>{n.d(t,{u:()=>i});const i=async(e,t)=>{const n=document.createElement("textarea");n.value=e,n.style.top="-100000px",n.style.left="0",n.style.position="fixed",(t||document.body).appendChild(n),n.focus(),n.select();try{const e=document.execCommand("copy");return n.remove(),e}catch(i){return!1}}},34094:(e,t,n)=>{n.d(t,{v:()=>o});var i=n(8450),r=n.n(i);const o=async({query:e,variables:t})=>{const n=r()({query:e.replace(/\s{2,}/g," "),variables:t}),i=new Headers;i.append("Content-Type","application/json");const o={method:"POST",headers:i,body:n};return fetch("https://bilibilihelper.com/g",o).then(e=>e.json()).catch(e=>!1)}},44943:(e,t,n)=>{n.d(t,{L:()=>l,__:()=>p});var i=n(73473),r=n.n(i),o=n(58971),a=n.n(o);const l=()=>new(r())(e=>{window.i18nMap||(chrome.runtime.getBackgroundPage?chrome.runtime.getBackgroundPage(t=>{window.i18nMap=t.i18nMap,e()}):chrome.runtime.sendMessage({target:"language",event:"getI18nMap"},t=>{window.i18nMap=t,e()}))});let c,s=a().get("bilibili-helper-2-language")||{},d="zh-CN",u=1e3;const p=(e,t=null)=>{if(c||(c=setTimeout(()=>{s=a().get("bilibili-helper-2-language")||{},d="zh-CN",c=null},u)),"auto"===d||d===chrome.i18n.getUILanguage())return chrome.i18n.getMessage(e,t);if(window.i18nMap&&d in window.i18nMap){const n=window.i18nMap[d][e];if(n){const{message:e,placeholders:i={}}=n;let r=e;const o=/\$(.+?)\$/g.exec(e);if(o){const n=o.slice(1);n.map(e=>e.toLowerCase()).map(n=>{n in i&&(r=e.replaceAll(new RegExp(`\\$${n}\\$`,"ig"),()=>t.shift()))})}return r}return""}return""}},48903:(e,t,n)=>{n.d(t,{__:()=>o.__,copy2Clipboard:()=>p.u,createTabByURL:()=>l.i$,fromNow:()=>a.Zh,generateShortcutValue:()=>u.S,getChromeVersion:()=>l.vu,getURL:()=>l.Ax,initI18n:()=>o.L,isBiggerThan:()=>i.Q$,isMacOS:()=>l.eE,isSuperVIP:()=>function(){return true},isVIP:()=>function(){return true},parseNumberByBase:()=>r.U,parseTime:()=>a.TD,sendGraphQLRequest:()=>d.v,version:()=>i.i8,videoPublishDescription:()=>a.S1});var i=n(47622),r=n(3437),o=n(44943),a=n(15558),l=n(48950),c=n(42151);n.o(c,"ToCDB")&&n.d(t,{ToCDB:function(){return c.ToCDB}}),n.o(c,"bv2av")&&n.d(t,{bv2av:function(){return c.bv2av}}),n.o(c,"copy2Clipboard")&&n.d(t,{copy2Clipboard:function(){return c.copy2Clipboard}}),n.o(c,"copyImage2Clipboard")&&n.d(t,{copyImage2Clipboard:function(){return c.copyImage2Clipboard}}),n.o(c,"decodeHTMLEntries")&&n.d(t,{decodeHTMLEntries:function(){return c.decodeHTMLEntries}}),n.o(c,"encodeHTMLEntries")&&n.d(t,{encodeHTMLEntries:function(){return c.encodeHTMLEntries}}),n.o(c,"fetchFromHelper")&&n.d(t,{fetchFromHelper:function(){return c.fetchFromHelper}}),n.o(c,"generateShortcutValue")&&n.d(t,{generateShortcutValue:function(){return c.generateShortcutValue}}),n.o(c,"generateURLByParams")&&n.d(t,{generateURLByParams:function(){return c.generateURLByParams}}),n.o(c,"getFilename")&&n.d(t,{getFilename:function(){return c.getFilename}}),n.o(c,"getPageDataInWindow")&&n.d(t,{getPageDataInWindow:function(){return c.getPageDataInWindow}}),n.o(c,"inLiveRoom")&&n.d(t,{inLiveRoom:function(){return c.inLiveRoom}}),n.o(c,"inMessageWhisper")&&n.d(t,{inMessageWhisper:function(){return c.inMessageWhisper}}),n.o(c,"injectIconfont")&&n.d(t,{injectIconfont:function(){return c.injectIconfont}}),n.o(c,"injectScript")&&n.d(t,{injectScript:function(){return c.injectScript}}),n.o(c,"injectStyle")&&n.d(t,{injectStyle:function(){return c.injectStyle}}),n.o(c,"injectStyleLink")&&n.d(t,{injectStyleLink:function(){return c.injectStyleLink}}),n.o(c,"interval")&&n.d(t,{interval:function(){return c.interval}}),n.o(c,"isFireFox")&&n.d(t,{isFireFox:function(){return c.isFireFox}}),n.o(c,"isSuperVIP")&&n.d(t,{isSuperVIP:function(){return true}}),n.o(c,"isVIP")&&n.d(t,{isVIP:function(){return true}}),n.o(c,"isValidEmail")&&n.d(t,{isValidEmail:function(){return c.isValidEmail}}),n.o(c,"removeInjectedStyleLink")&&n.d(t,{removeInjectedStyleLink:function(){return c.removeInjectedStyleLink}}),n.o(c,"sendGraphQLRequest")&&n.d(t,{sendGraphQLRequest:function(){return c.sendGraphQLRequest}}),n.o(c,"webRequestCallbackWrapper")&&n.d(t,{webRequestCallbackWrapper:function(){return c.webRequestCallbackWrapper}});var s=n(92593);n.o(s,"ToCDB")&&n.d(t,{ToCDB:function(){return s.ToCDB}}),n.o(s,"bv2av")&&n.d(t,{bv2av:function(){return s.bv2av}}),n.o(s,"copy2Clipboard")&&n.d(t,{copy2Clipboard:function(){return s.copy2Clipboard}}),n.o(s,"copyImage2Clipboard")&&n.d(t,{copyImage2Clipboard:function(){return s.copyImage2Clipboard}}),n.o(s,"decodeHTMLEntries")&&n.d(t,{decodeHTMLEntries:function(){return s.decodeHTMLEntries}}),n.o(s,"encodeHTMLEntries")&&n.d(t,{encodeHTMLEntries:function(){return s.encodeHTMLEntries}}),n.o(s,"fetchFromHelper")&&n.d(t,{fetchFromHelper:function(){return s.fetchFromHelper}}),n.o(s,"generateShortcutValue")&&n.d(t,{generateShortcutValue:function(){return s.generateShortcutValue}}),n.o(s,"generateURLByParams")&&n.d(t,{generateURLByParams:function(){return s.generateURLByParams}}),n.o(s,"getFilename")&&n.d(t,{getFilename:function(){return s.getFilename}}),n.o(s,"getPageDataInWindow")&&n.d(t,{getPageDataInWindow:function(){return s.getPageDataInWindow}}),n.o(s,"inLiveRoom")&&n.d(t,{inLiveRoom:function(){return s.inLiveRoom}}),n.o(s,"inMessageWhisper")&&n.d(t,{inMessageWhisper:function(){return s.inMessageWhisper}}),n.o(s,"injectIconfont")&&n.d(t,{injectIconfont:function(){return s.injectIconfont}}),n.o(s,"injectScript")&&n.d(t,{injectScript:function(){return s.injectScript}}),n.o(s,"injectStyle")&&n.d(t,{injectStyle:function(){return s.injectStyle}}),n.o(s,"injectStyleLink")&&n.d(t,{injectStyleLink:function(){return s.injectStyleLink}}),n.o(s,"interval")&&n.d(t,{interval:function(){return s.interval}}),n.o(s,"isFireFox")&&n.d(t,{isFireFox:function(){return s.isFireFox}}),n.o(s,"isSuperVIP")&&n.d(t,{isSuperVIP:function(){return true}}),n.o(s,"isVIP")&&n.d(t,{isVIP:function(){return true}}),n.o(s,"isValidEmail")&&n.d(t,{isValidEmail:function(){return s.isValidEmail}}),n.o(s,"removeInjectedStyleLink")&&n.d(t,{removeInjectedStyleLink:function(){return s.removeInjectedStyleLink}}),n.o(s,"sendGraphQLRequest")&&n.d(t,{sendGraphQLRequest:function(){return s.sendGraphQLRequest}}),n.o(s,"webRequestCallbackWrapper")&&n.d(t,{webRequestCallbackWrapper:function(){return s.webRequestCallbackWrapper}});var d=n(34094),u=n(39417);if(/^(166|815)$/.test(n.j))var p=n(49355);var m=n(49675),v=n(25498);n.o(v,"ToCDB")&&n.d(t,{ToCDB:function(){return v.ToCDB}}),n.o(v,"bv2av")&&n.d(t,{bv2av:function(){return v.bv2av}}),n.o(v,"copyImage2Clipboard")&&n.d(t,{copyImage2Clipboard:function(){return v.copyImage2Clipboard}}),n.o(v,"decodeHTMLEntries")&&n.d(t,{decodeHTMLEntries:function(){return v.decodeHTMLEntries}}),n.o(v,"encodeHTMLEntries")&&n.d(t,{encodeHTMLEntries:function(){return v.encodeHTMLEntries}}),n.o(v,"fetchFromHelper")&&n.d(t,{fetchFromHelper:function(){return v.fetchFromHelper}}),n.o(v,"generateURLByParams")&&n.d(t,{generateURLByParams:function(){return v.generateURLByParams}}),n.o(v,"getFilename")&&n.d(t,{getFilename:function(){return v.getFilename}}),n.o(v,"getPageDataInWindow")&&n.d(t,{getPageDataInWindow:function(){return v.getPageDataInWindow}}),n.o(v,"inLiveRoom")&&n.d(t,{inLiveRoom:function(){return v.inLiveRoom}}),n.o(v,"inMessageWhisper")&&n.d(t,{inMessageWhisper:function(){return v.inMessageWhisper}}),n.o(v,"injectIconfont")&&n.d(t,{injectIconfont:function(){return v.injectIconfont}}),n.o(v,"injectScript")&&n.d(t,{injectScript:function(){return v.injectScript}}),n.o(v,"injectStyle")&&n.d(t,{injectStyle:function(){return v.injectStyle}}),n.o(v,"injectStyleLink")&&n.d(t,{injectStyleLink:function(){return v.injectStyleLink}}),n.o(v,"interval")&&n.d(t,{interval:function(){return v.interval}}),n.o(v,"isFireFox")&&n.d(t,{isFireFox:function(){return v.isFireFox}}),n.o(v,"isValidEmail")&&n.d(t,{isValidEmail:function(){return v.isValidEmail}}),n.o(v,"removeInjectedStyleLink")&&n.d(t,{removeInjectedStyleLink:function(){return v.removeInjectedStyleLink}}),n.o(v,"webRequestCallbackWrapper")&&n.d(t,{webRequestCallbackWrapper:function(){return v.webRequestCallbackWrapper}})},3437:(e,t,n)=>{n.d(t,{U:()=>a});var i=n(79529),r=n.n(i);const o={4:"\u4e07",8:"\u4ebf"},a=(e,t=1e4)=>{if("number"!==typeof e)return e;if(e<t)return e;const n=r()(String(Math.log10(t)),10),i=o[n]||"",a=Number(e/t).toFixed(2);return Number(a).toLocaleString()+i}},39417:(e,t,n)=>{n.d(t,{S:()=>a});const i={ArrowUp:"\u2191",ArrowRight:"\u2192",ArrowDown:"\u2193",ArrowLeft:"\u2190"},r=/^(571|815)$/.test(n.j)?["ControlLeft","ControlRight","ShiftLeft","ShiftRight","AltLeft","AltRight","MetaLeft","MetaRight","Enter","Space","CapsLock"]:null,o={Minus:"-",Equal:"=",Backquote:"`",BracketLeft:"[",BracketRight:"]",Backslash:"\\",Semicolon:";",Quote:"'",Comma:",",Period:".",Slash:"/"},a=(e,t,n,a,l,c)=>{let s=[];return n&&s.push("Control"),a&&s.push("Shift"),l&&s.push("Command"),c&&s.push("Alt"),t=i[e]?e:/Key[A-Z]/.test(e)?e.replace("Key","").toLowerCase():/Digit(\d)/.test(e)?e.replace("Digit",""):o[e]?o[e]:t.toLowerCase(),!(r.includes(e)||!e||!t)&&(s.push(t),s.join(" + "))}},47622:(e,t,n)=>{n.d(t,{Q$:()=>l,i8:()=>o,ng:()=>a});var i=n(79529),r=n.n(i);const o=chrome.runtime.getManifest().version,a=()=>{},l=(e,t)=>{if(e===t)return 0;let n=e.split("."),i=t.split("."),o=Math.min(n.length,i.length);for(let a=0;a<o;a++){if(r()(n[a]||0)>r()(i[a]||0))return 1;if(r()(n[a]||0)<r()(i[a]||0))return-1}return n.length>i.length?1:n.length<i.length?-1:0}},90137:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(t){o(t)}}function l(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):r(e.value).then(a,l)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentFrame=t.onVideoChange=t.getAutoPlayModeButtons=t.getCurrentAutoPlayMode=t.showPlaySpeedTip=t.getDANMUButton=t.getFullFillWidenButton=t.getWebWidenButton=t.getNormalWidenButton=t.getSpeedBtn=t.getVideoElement=t.getCurrentWideType=t.getCurrentQuality=t.VIDEO_QUALITY_NUMBER_LIST=t.VIDEO_QUALITY_MAP=t.bv2av=t.av2bv=t.isVideoLink=t.isBvid=t.toBvURL=void 0;const r=n(92593),o=e=>"https://www.bilibili.com/video/"+e;t.toBvURL=o;const a=e=>/^bv[\w]+$/i.test(e);t.isBvid=a;const l=e=>{const t=new URL(e),n=/^\/(?:video|bangumi\/play)\/(BV|bv|av|ep|ss)([\da-zA-Z]+)/.exec(t.pathname);return!!n};t.isVideoLink=l;const c={table:"fZodR9XQDSUm21yCkr6zBqiveYah8bt4xsWpHnJE7jL5VG3guMTKNPAwcF",map:JSON.parse('{"1":13,"2":12,"3":46,"4":31,"5":43,"6":18,"7":40,"8":28,"9":5,"f":0,"Z":1,"o":2,"d":3,"R":4,"X":6,"Q":7,"D":8,"S":9,"U":10,"m":11,"y":14,"C":15,"k":16,"r":17,"z":19,"B":20,"q":21,"i":22,"v":23,"e":24,"Y":25,"a":26,"h":27,"b":29,"t":30,"x":32,"s":33,"W":34,"p":35,"H":36,"n":37,"J":38,"E":39,"j":41,"L":42,"V":44,"G":45,"g":47,"u":48,"M":49,"T":50,"K":51,"N":52,"P":53,"A":54,"w":55,"c":56,"F":57}'),s:[11,10,3,8,4,6],xor:177451812,add:8728348608},s=e=>{if("number"===typeof e){e=(e^c.xor)+c.add;const t=["B","V","1"," "," ","4"," ","1"," ","7"," "," "];for(let n=0;n<6;++n)t[c.s[n]]=c.table[Math.floor(e/Math.pow(58,n))%58];return t.join("")}};t.av2bv=s;const d=e=>{10===e.length&&"bv"!==String(e).slice(0,2).toLowerCase()&&(e="BV"+e);let t=0;for(let n=0;n<6;++n)t+=c.map[e[c.s[n]]]*Math.pow(58,n);return t-c.add^c.xor};t.bv2av=d,t.VIDEO_QUALITY_MAP={127:"8K \u8d85\u9ad8\u6e05",126:"\u675c\u6bd4\u89c6\u754c",125:"HDR \u771f\u5f69",120:"4K",116:"1080P 60\u5e27",112:"1080P \u9ad8\u7801\u7387",80:"1080P \u9ad8\u6e05",64:"720P \u9ad8\u6e05",32:"480P \u6e05\u6670",16:"360P \u6d41\u7545",0:"\u81ea\u52a8"},t.VIDEO_QUALITY_NUMBER_LIST=[127,126,125,120,116,112,80,64,32,16];const u=()=>i(void 0,void 0,void 0,(function*(){var e,t;const n=document.querySelector(".bilibili-player-video-quality-menu .bui-select-item-active,.squirtle-quality-select-list .squirtle-select-item.active,.bpx-player-ctrl-quality .bpx-player-ctrl-quality-menu-item.bpx-state-active,.bpx-player-ctrl-quality-menu .bpx-state-active");let i=Number(null===(e=null===n||void 0===n?void 0:n.dataset)||void 0===e?void 0:e.value);if(i)return Number(i);const r=Array.from(document.querySelectorAll(".bilibili-player-video-quality-menu .bui-select-item,.bpx-player-ctrl-quality-menu-item")),o=document.querySelector(".bilibili-player-video-quality-menu .bui-select-item .bilibili-player-auto-hidden,.bpx-player-ctrl-quality-menu .bpx-state-active"),a=null===o||void 0===o?void 0:o.textContent,l=r.find(e=>{var t;return(null===(t=null===e||void 0===e?void 0:e.querySelector(".bilibili-player-video-quality-text, .bpx-player-ctrl-quality-text"))||void 0===t?void 0:t.textContent)===a});return l&&l instanceof HTMLElement?Number(null===(t=null===l||void 0===l?void 0:l.dataset)||void 0===t?void 0:t.value):void 0}));t.getCurrentQuality=u;const p=()=>i(void 0,void 0,void 0,(function*(){var e;const t=document.querySelector(".bpx-player-container"),n=document.getElementById("bilibiliPlayer");let i;if(t instanceof HTMLElement)return i=String(null===(e=null===t||void 0===t?void 0:t.dataset)||void 0===e?void 0:e.screen),i;if(n){switch(i=Array.from(n.classList).find(e=>["mode-widescreen","mode-webfullscreen","mode-fullscreen"].includes(e)),i){case"mode-widescreen":i="wide";break;case"mode-webfullscreen":i="web";break;case"mode-fullscreen":i="full";break;default:i="normal"}return i}}));t.getCurrentWideType=p;const m=(e=!0)=>i(void 0,void 0,void 0,(function*(){return e?document.querySelector("#bilibiliPlayer .bilibili-player-video video, #bilibili-player video"):yield(0,r.interval)("#bilibiliPlayer .bilibili-player-video video, #bilibili-player video")}));t.getVideoElement=m;const v=e=>{let t=document.querySelector(`.bilibili-player-video-btn-speed-menu [data-value="${+e.toFixed(2)}"], .squirtle-speed-select-list [data-value="${+e.toFixed(2)}"], .bpx-player-ctrl-playbackrate-menu [data-value="${+e.toFixed(2)}"]`);return t||Array.from(document.querySelectorAll(".bilibili-player-video-btn-speed-menu .bilibili-player-video-btn-speed-menu-list, .squirtle-speed-select-list .squirtle-select-item, .bpx-player-ctrl-playbackrate-menu .bpx-player-ctrl-playbackrate-menu")).find(t=>{if(+t.textContent.replace("x","")===e)return!0})};t.getSpeedBtn=v;const f=(e,t=!0)=>i(void 0,void 0,void 0,(function*(){return t?Promise.resolve(document.querySelector(e)):yield(0,r.interval)(e,1e3,1/0)})),b=(e=!0,t=!1)=>i(void 0,void 0,void 0,(function*(){let n=".bilibili-player-video-btn.bilibili-player-video-btn-widescreen:not(.closed), .squirtle-controller-wrap-right .squirtle-video-widescreen:not(.active), .bpx-player-control-bottom-right .bpx-player-ctrl-wide:not(.bpx-state-entered)";return t&&(n=".bilibili-player-video-btn.bilibili-player-video-btn-widescreen, .squirtle-controller-wrap-right .squirtle-video-widescreen, .bpx-player-control-bottom-right .bpx-player-ctrl-wide"),yield f(n,e)}));t.getNormalWidenButton=b;const g=(e=!0,t=!1)=>i(void 0,void 0,void 0,(function*(){let n=".bilibili-player-video-btn.bilibili-player-video-web-fullscreen:not(.closed), .squirtle-controller-wrap-right .squirtle-video-pagefullscreen:not(.active), .bpx-player-control-bottom-right .bpx-player-ctrl-web:not(.bpx-state-entered)";return t&&(n=".bilibili-player-video-btn.bilibili-player-video-web-fullscreen, .squirtle-controller-wrap-right .squirtle-video-pagefullscreen, .bpx-player-control-bottom-right .bpx-player-ctrl-web"),yield f(n,e)}));t.getWebWidenButton=g;const h=(e=!0,t=!1)=>i(void 0,void 0,void 0,(function*(){let n=".bilibili-player-video-btn.bilibili-player-video-btn-fullscreen:not(.closed), .squirtle-controller-wrap-right .squirtle-video-fullscreen:not(.active), .bpx-player-ctrl-full";return t&&(n=".bilibili-player-video-btn.bilibili-player-video-btn-fullscreen, .squirtle-controller-wrap-right .squirtle-video-fullscreen, .bpx-player-ctrl-full"),yield f(n,e)}));t.getFullFillWidenButton=h;const y=(e=!0,t=!1)=>i(void 0,void 0,void 0,(function*(){let n='.bilibili-player-video-danmaku-switch input[type="checkbox"]';const i=yield f(n,e);return i?t?Promise.resolve(i.checked?i:null):Promise.resolve(i.checked?null:i):null}));t.getDANMUButton=y;const w=e=>{let t,n=document.querySelector("#bilibiliSpeedTip");if(n)n.innerHTML=`\uff1e\uff1e ${e.toFixed(2)}x`,clearTimeout(t);else{n=document.createElement("div"),n.id="bilibiliSpeedTip",n.innerHTML=`\uff1e\uff1e ${e.toFixed(2)}x`;const t=document.querySelector(".bilibili-player-video-wrap, .bpx-player-video-wrap");t.appendChild(n)}t=setTimeout(()=>{n&&n.remove()},1e3)};t.showPlaySpeedTip=w;const L=()=>{const[e]=Array.from(document.querySelectorAll("\n\t\t\t.bilibili-player-video-btn-setting-wrap .bilibili-player-video-btn-setting-right-playtype input\n    "));if(void 0!==e)return null===e||void 0===e?void 0:e.checked;const[t]=Array.from(document.querySelectorAll("\n\t\t\t.squirtle-setting-wrap .squirtle-handoff *\n    "));return t?null===t||void 0===t?void 0:t.classList.contains("active"):void 0};t.getCurrentAutoPlayMode=L;const S=()=>i(void 0,void 0,void 0,(function*(){return(0,r.interval)(".squirtle-setting-wrap").then(e=>{if(!e)return;const[t,n]=Array.from(document.querySelectorAll("\n\t\t\t\t\t.bilibili-player-video-btn-setting-wrap .bilibili-player-video-btn-setting-right-playtype input\n        "));if(void 0!==t&&void 0!==n)return[t,n];const i=Array.from(document.querySelectorAll("\n\t\t\t\t\t.squirtle-setting-wrap .squirtle-handoff *\n        "));return 2===i.length?i:void 0})}));t.getAutoPlayModeButtons=S;const I=e=>{let n;(0,t.getVideoElement)(!1).then(t=>i(void 0,void 0,void 0,(function*(){if(t){let i;n=t,yield e(n);const r=document.querySelector("#bilibili-player");r&&new MutationObserver(t=>{clearTimeout(i);let r,o=!1;t.forEach(e=>{e.addedNodes.length>0&&e.addedNodes.forEach(e=>{e.classList.contains("player")&&(o=!0,r=e)})}),o&&(n=r.querySelector("video"),i=setTimeout(()=>e(n),500))}).observe(r,{childList:!0}),new MutationObserver(n=>{let r,o=!1;n.forEach(n=>{n.addedNodes.length>0?(n.addedNodes.forEach(e=>{"VIDEO"===e.tagName&&(o=!0,r=e)}),o&&r&&(clearTimeout(i),i=setTimeout(()=>e(r),500))):"attributes"===n.type&&"src"===n.attributeName&&(clearTimeout(i),i=setTimeout(()=>e(t),500))})}).observe(t,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["src"]})}})))};t.onVideoChange=I;const C=()=>i(void 0,void 0,void 0,(function*(){const e=yield(0,t.getVideoElement)(!0);if(e&&e instanceof HTMLVideoElement){e.crossOrigin="Anonymous";const t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;const n=t.getContext("2d");return n.drawImage(e,0,0,e.videoWidth,e.videoHeight),t.toDataURL("image/jpeg",100)}}));t.getCurrentFrame=C},92593:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(t){o(t)}}function l(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):r(e.value).then(a,l)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.copyImage2Clipboard=t.injectScript=t.getPageDataInWindow=t.injectStyleLink=t.removeInjectedStyleLink=t.injectStyle=t.getMouseRelativePosition=t.getDOMRelativePosition=t.interval=t.observer=t.getContainer=void 0;const o=n(29887),a=r(n(96486)),l=e=>{const t=e=>{const t=document.querySelectorAll(e);return t.length>0&&t};if("string"===typeof e){const n=t(e);return!!(n&&n.length>0)&&n[0]}if(e instanceof Array){const n=a.default.compact(e.map(e=>t(e)));if(n.length>0)return a.default.compact(e.map(e=>t(e)))[0]}};t.getContainer=l;const c=(e,n=500)=>{if(!e)throw"Wrong containerSelectors: "+e;return new Promise(i=>{const r=(0,t.getContainer)(e);let o;r||i(!1);let a=!1;o=setTimeout(()=>{a=!0,i(r)},n),new MutationObserver((function(e,t){a&&t.disconnect(),o&&clearTimeout(o),o=setTimeout(()=>{t.disconnect(),i(r)},n)})).observe(r[0],{childList:!0,attributes:!0,attributeOldValue:!0,subtree:!0})})};t.observer=c;const s=(e,n=500,i=15)=>{-1===i&&n<1e3&&(n=1e3);let r=0;const o=(n,a)=>{let l=setInterval(()=>{const c=(0,t.getContainer)(e);if(c)clearInterval(l),n(c);else if(r<i||-1===i){++r;const e=a*r;e>=3e4&&(clearInterval(l),a=1e3,o(n,a))}else clearInterval(l),n()},a)};return new Promise(e=>{o(e,n)})};t.interval=s;const d=(e,t="body")=>{const n=e.closest(t),{left:i,top:r}=e.getClientRects()[0],{left:a,top:l}=n.getClientRects()[0];return new o.Position(i-a,r-l)};t.getDOMRelativePosition=d;const u=(e,t)=>{const{x:n,y:i}=e,{left:r,top:a,width:l}=t.getClientRects()[0];return new o.Position(l-n+r,i-a)};t.getMouseRelativePosition=u;const p=(e,t)=>{const n=document.createElement("style");return n.id=e,n.innerHTML=t,document.head.appendChild(n),n};t.injectStyle=p;const m=e=>{let t=document.getElementById("bilibili_style_link_"+e);null===t||void 0===t||t.remove()};t.removeInjectedStyleLink=m;const v=(e=String(1e3*Math.random()).substring(2,8),t,n=!1)=>{let i=document.getElementById("bilibili_style_link_"+e);if(i){if(!n)return void i.setAttribute("href",t);i.remove(),i=null}if(!i){const n=document.createElement("link");n.setAttribute("id","bilibili_style_link_"+e),document.head.appendChild(n),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t)}};t.injectStyleLink=v;const f=(e,t)=>i(void 0,void 0,void 0,(function*(){return void 0===e||"string"!==typeof e?Promise.resolve(!1):new Promise(n=>{const i=document.createElement("script");i.innerHTML=e,document.body.appendChild(i);const r=e=>{const{data:o}=e;o.command===t&&(n(o.pageData),i.remove(),window.removeEventListener("message",r))};window.addEventListener("message",r)})}));t.getPageDataInWindow=f;const b=(e,t=0)=>new Promise(n=>{const i=document.createElement("script");i.innerHTML=e,document.body.appendChild(i),t&&setTimeout(()=>{i.remove(),n(!0)},t)});t.injectScript=b;const g=e=>i(void 0,void 0,void 0,(function*(){const t=yield navigator.permissions.query({name:"clipboard-write"});return!(!t||!window.ClipboardItem)&&new Promise(t=>{const n=new Image,i=document.createElement("canvas"),r=i.getContext("2d");n.onload=function(){i.width=this.naturalWidth,i.height=this.naturalHeight,r.drawImage(this,0,0),i.toBlob(e=>{navigator.clipboard.write([new window.ClipboardItem({[e.type]:e})]).then(()=>{t(!0)}).catch(()=>{t(!1)})},"image/png",1)},n.src=e})}));t.copyImage2Clipboard=g},42151:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseFileSize=t.ToCDB=t.isValidEmail=t.decodeHTMLEntries=t.encodeHTMLEntries=t.injectLocalIconfont=t.injectIconfont=t.webRequestCallbackWrapper=t.getUID=t.generateURLByParams=t.fetchFromHelper=t.inActivityLiveParentRoom=t.inReplayLiveRoom=t.inLiveRoom=t.inMessageWhisper=t.inNormalVideoPage=t.inVideoPage=t.getFilename=void 0;const a=o(n(84564)),l=o(n(96486)),c=n(92593),s=e=>{const t=e.querySelector(["#v_multipage a.on","#multi_page .cur-list li.on a","#eplist_module .list-wrapper ul .cursor"].join(", ")),n=t?t.innerText:"",i=e.querySelector(["#viewbox_report h1",".header-info h1",".media-wrapper > h1","h1.video-title",".bilibili-player-video-top-title",".bilibili-player-video-suspension-bar-title-text"].join(", "));return`${i?i.getAttribute("title")||i.textContent:""}${n?"_"+n:""}`.replace(/\s/g,"").replace(/[|"*?:<>\s~/]/g,"_")};t.getFilename=s;const d=()=>!!/^\/((?:video\/(bv.+|BV.+|av\d+))|festival|blackboard\/newplayer\.html|bangumi\/play|cheese\/play|medialist\/play|list\/|player\.html)/.exec(window.location.pathname);t.inVideoPage=d;const u=()=>!!/^\/(?:video\/(bv.+|BV.+|av\d+))/.exec(window.location.pathname);t.inNormalVideoPage=u;const p=()=>!!/^#\/whisper/.exec(window.location.hash);t.inMessageWhisper=p;const m=()=>!!/^\/((?:blanc\/)?\d+|record\/(R.+))/.exec(window.location.pathname);t.inLiveRoom=m;const v=()=>!!/^\/record\/(R.+)/.exec(window.location.pathname);t.inReplayLiveRoom=v;const f=()=>!!document.querySelector('[data-module="live-non-revenue-player"]')||!document.querySelector(".live-room-app");t.inActivityLiveParentRoom=f;const b=(e,t)=>{t?t.headers instanceof Headers?t.headers.append("From","bilibili-helper"):t.headers instanceof Object?t.headers=new Headers(Object.assign(Object.assign({},t.headers),{From:"bilibili-helper"})):t.headers=new Headers({From:"bilibili-helper"}):t={headers:new Headers({From:"bilibili-helper"})};const n=new a.default(e,"");return fetch(decodeURIComponent(n.href),t).catch(e=>{})};t.fetchFromHelper=b;const g=(e,t={})=>`${e}?${Object.keys(t).map(e=>`${e}=${t[e]}`).join("&")}`;t.generateURLByParams=g;const h=()=>{};t.getUID=h;const y=function(e,t){const{once:n=!1}=t||{once:!1},i=new Set,r=new Set,o=new Map;return function(t){const{initiator:a,requestHeaders:c,url:s,type:d,tabId:u,requestId:p}=t;let m=!1;if(o.has(p)&&clearTimeout(o.get(p)),r.has(p)?m=!0:r.add(p),o.set(p,setTimeout(()=>{r.delete(p),o.delete(p)},2e3)),m)return;if(n){if(i.has(s))return;i.add(s),setTimeout(()=>{i.delete(s)},1e3)}const v=!l.default.isEmpty(l.default.find(c,({name:e,value:t})=>"from"===e.toLowerCase()&&t.toLowerCase().match("bilibili_helper_2"))),f=!!s&&!!s.match(/^https?:\/\/(?:.+?).bilibili.com\/?/)&&"main_frame"===d,b=(a&&/^chrome-extension:\/\//.test(a)||-1===u)&&!f,g=!!s.match(/passWrapper=true/),h=!l.default.isEmpty(l.default.find(c,({name:e,value:t})=>"passwrapper"===e.toLowerCase()&&"true"===String(t.toLowerCase())));if(h&&c){const e=c.findIndex(e=>"passwrapper"===e.name.toLowerCase());e&&c.splice(e,1)}return(g||h||!v&&!b)&&e instanceof Function?e.call(this,t):void 0}};t.webRequestCallbackWrapper=y;const w=(e="font_1690169_6hxr570d2oh")=>{(0,c.injectStyleLink)(e,`https://at.alicdn.com/t/${e}.css`)};t.injectIconfont=w;const L=(e="font_1690169_udkuh25jp3h")=>{(0,c.injectStyleLink)(e,chrome.runtime.getURL(`statics/iconfonts/${e}/iconfont.css`),!0)};t.injectLocalIconfont=L,r(n(47061),t);const S=e=>{try{return e.replace(/(["'&<>])/g,e=>{switch(e){case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return e}})}catch(t){}};t.encodeHTMLEntries=S;const I=e=>{if(!e)return e;try{return e.replace(/&(quot|apos|amp|lt|gt);/g,e=>{switch(e){case"quot":return'"';case"apos":return"'";case"amp":return"&";case"lt":return"<";case"gt":return">";default:return e}})}catch(t){return e}};t.decodeHTMLEntries=I;const C=e=>{const t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())};t.isValidEmail=C;const P=e=>{let t="";for(var n=0;n<e.length;n++)12288!==e.charCodeAt(n)?e.charCodeAt(n)>65280&&e.charCodeAt(n)<65375?t+=String.fromCharCode(e.charCodeAt(n)-65248):t+=e[n]:t+=String.fromCharCode(e.charCodeAt(n)-12256);return t};t.ToCDB=P;const x=1,E=1e3*x,T=1e3*E,M=1e3*T,q=1e3*M,R=1e3*q,j=1e3*R,B=e=>{let t,n,i;return e>=j?(i=j,n="EB"):e>=R?(i=R,n="PB"):e>=q?(i=q,n="TB"):e>=M?(i=M,n="GB"):e>=T?(i=T,n="MB"):e>=E?(i=E,n="KB"):(i=x,n="Byte"),t=Number((e/i).toFixed(2)),{number:t,unit:n}};t.parseFileSize=B}}]);